<div class="modal-header">
    <h4 class="modal-title">Create Printer</h4>
    <button type="button" class="btn-close" aria-label="Close"
        (click)="activeModal.dismiss('Cross click')"></button><br />
</div>
<div class="modal-body p-4">
    <div>
        <p>API Key: <span class="bg-light text-black fw-bold p-1">{{ APIKEY }}</span></p>
    </div>
    <hr>
    <div class="opening-hours-container">
        <ul ngbNav #nav="ngbNav" [(activeId)]="activeService" class="nav-tabs secondary-nav">
            <li [ngbNavItem]="1">
                <a ngbNavLink>General</a>
                <ng-template ngbNavContent>
                    <div class="mt-4">
                        <form>
                            <div class="mb-4">
                                <label for="name" class="form-label fw-bold">Name</label>
                                <input type="text" class="form-control" id="name" name="name"
                                    [(ngModel)]="printer.name" />
                                <small class="form-text text-muted">
                                    Printer configuration name. It is only used to help you
                                    identify this configuration
                                </small>
                            </div>
                            <div class="mb-4">
                                <label for="posTerminals" class="form-label fw-bold">Restrict To POS Terminals</label>
                                <input type="text" class="form-control" id="posTerminals" name="posTerminals"
                                    placeholder="Select from the dropdown or type to search..." />
                                <small class="form-text text-muted">
                                    Restrict this printer to be accessible or only print
                                    automatically for the selected POS terminal
                                </small>
                            </div>
                            <div class="mb-4 d-flex flex-column">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch" id="disablePrinter"
                                        name="disablePrinter" [(ngModel)]="printer.disablePrinter" />
                                    <label class="form-check-label fw-bold" for="disablePrinter">
                                        Disable Printer
                                    </label>
                                </div>
                                <small class="form-text text-muted">
                                    Disable this printer from being used without deleting it
                                </small>
                            </div>
                        </form>
                    </div>
                </ng-template>
            </li>
            <li [ngbNavItem]="2">
                <a ngbNavLink>Auto Print</a>
                <ng-template ngbNavContent>
                    <div class="mt-4">
                        <form>
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <label class="form-check-label fw-bold">Auto Print Orders</label>
                                    <p>
                                        Automatically print out new online orders when they are
                                        placed
                                    </p>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch" id="autoPrintOrders"
                                        name="autoPrintOrders" [(ngModel)]="printer.autoPrintOrders" />
                                </div>
                            </div>
                            <hr class="dotted-divider" />
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <label class="form-check-label fw-bold">Auto Print Bookings</label>
                                    <p>Automatically print out new online bookings when they are placed</p>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch" id="autoPrintBookings"
                                        name="autoPrintBookings" [(ngModel)]="printer.autoPrintBookings" />
                                </div>
                            </div>
                            <hr class="dotted-divider" />

                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <label class="form-check-label fw-bold">POS - Auto Print Orders</label>
                                    <p>Automatically print out new orders when they are placed in your POS</p>
                                </div>

                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch"
                                        id="posAutoPrintOrders" name="posAutoPrintOrders"
                                        [(ngModel)]="printer.posAutoPrintOrders" />
                                </div>
                            </div>
                            <hr class="dotted-divider" />

                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <label class="form-check-label fw-bold">POS - Auto Print Order Edits</label>
                                    <p>Automatically print out new dishes added to an existing order</p>
                                </div>

                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch"
                                        id="posAutoPrintOrderEdits" name="posAutoPrintOrderEdits"
                                        [(ngModel)]="printer.posAutoPrintOrderEdits" />
                                </div>
                            </div>
                            <hr class="dotted-divider" />

                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <label class="form-check-label fw-bold">POS - Auto Print Bookings</label>
                                    <p>Automatically print out new bookings when they are placed in your POS</p>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch"
                                        id="posAutoPrintBookings" name="posAutoPrintBookings"
                                        [(ngModel)]="printer.posAutoPrintBookings" />
                                </div>
                            </div>
                            <hr class="dotted-divider" />

                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <div>
                                    <label class="form-check-label fw-bold">Auto Print Delivery Updates</label>
                                    <p>Automatically print out updates related to deliveries, such as delays</p>
                                </div>

                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" role="switch"
                                        id="autoPrintDeliveryUpdates" name="autoPrintDeliveryUpdates"
                                        [(ngModel)]="printer.autoPrintDeliveryUpdates" />
                                </div>
                            </div>
                            <hr class="dotted-divider" />

                            <div class="mb-4">
                                <div class="d-flex justify-content-between align-items-center">
                                    <label class="form-label fw-bold">Auto Print Order Services</label>
                                    <span class="optional-badge">OPTIONAL</span>
                                </div>
                                <input type="text" class="form-control" name="autoPrintOrderServices"
                                    [(ngModel)]="printer.autoPrintOrderServices"
                                    placeholder="Select from the dropdown or type to search..." />
                                <p>Select which services will trigger this receipt configuration to automatically print.
                                    Leaving this empty will auto print for all services</p>
                            </div>
                            <hr class="dotted-divider" />

                            <div class="mb-4">

                                <div class="d-flex justify-content-between align-items-center">
                                    <label class="form-label fw-bold">Auto Print Fail E-Mail</label>
                                    <span class="optional-badge">OPTIONAL</span>
                                </div>
                                <input type="email" class="form-control" name="autoPrintFailEmail"
                                    [(ngModel)]="printer.autoPrintFailEmail"
                                    placeholder="If an e-mail address is entered, whenever an automated print job fails, you will receive an e-mail notification" />
                                <p>If an e-mail address is entered, whenever an automated print job fails, you will
                                    receive an e-mail notification</p>
                            </div>
                        </form>
                    </div>
                </ng-template>
            </li>
            <li [ngbNavItem]="3">
                <a ngbNavLink>Printer Settings</a>
                <ng-template ngbNavContent>
                    <div class="mt-4">
                        <form>
                            <!-- Printing Method -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Printing Method</label>
                                <select class="form-select" [(ngModel)]="printer.printingMethod" name="printingMethod">
                                    <option value="ESC/POS">ESC/POS</option>
                                    <option value="Other">Other</option>
                                </select>
                                <small class="form-text text-muted">
                                    Determine whether the receipt should be printed through an installed printer driver
                                    or ESC/POS format.
                                </small>
                            </div>

                            <!-- Paper Width -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Paper Width (pixels)</label>
                                <input type="number" class="form-control" [(ngModel)]="printer.paperWidth"
                                    name="paperWidth" />
                                <small class="form-text text-muted">
                                    Think in your actual paper width, written in the width of the receipt image
                                    generated.
                                </small>
                            </div>

                            <!-- Paper Height -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Paper Height (pixels)</label>
                                <input type="number" class="form-control" [(ngModel)]="printer.paperHeight"
                                    name="paperHeight" />
                                <small class="form-text text-muted">
                                    This is not your actual paper height, rather it is the height of the receipt image
                                    generated.
                                </small>
                            </div>

                            <!-- Paper Scale Factor -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Paper Scale Factor</label>
                                <input type="number" class="form-control" [(ngModel)]="printer.paperScaleFactor"
                                    name="paperScaleFactor" />
                                <small class="form-text text-muted">
                                    Determines how "zoomed in" the image is. Usually a value of 2 will suit 80mm
                                    printers.
                                </small>
                            </div>

                            <!-- Paper Density -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Paper Density</label>
                                <select class="form-select" [(ngModel)]="printer.paperDensity" name="paperDensity">
                                    <option value="D24">D24</option>
                                    <option value="D20">D20</option>
                                    <option value="D15">D15</option>
                                </select>
                                <small class="form-text text-muted">Determined by your thermal printer. Most printers
                                    support "D24".</small>
                            </div>

                            <!-- Font Size -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Font Size</label>
                                <input type="number" class="form-control" [(ngModel)]="printer.fontSize"
                                    name="fontSize" />
                                <small class="form-text text-muted">The base font size used when generating your receipt
                                    (1â€“24).</small>
                            </div>

                            <!-- Number of Beeps -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Number Of Beeps</label>
                                <input type="number" class="form-control" [(ngModel)]="printer.numberOfBeeps"
                                    name="numberOfBeeps" />
                                <small class="form-text text-muted">Set how many times the printer should beep after
                                    printing.</small>
                            </div>

                            <!-- Beep Method -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Beep Method</label>
                                <select class="form-select" [(ngModel)]="printer.beepMethod" name="beepMethod">
                                    <option value="internal">Internal</option>
                                    <option value="external">External</option>
                                </select>
                                <small class="form-text text-muted">Choose which method will be used to send the
                                    beep/alert.</small>
                            </div>

                            <!-- Paper Cut Type -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Paper Cut Type</label>
                                <select class="form-select" [(ngModel)]="printer.paperCutType" name="paperCutType">
                                    <option value="full">Full Cut</option>
                                    <option value="partial">Partial Cut</option>
                                </select>
                                <small class="form-text text-muted">Determines which paper cut command is used at the
                                    end of a print job.</small>
                            </div>

                            <!-- Characters Per Line -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Characters Per Line</label>
                                <input type="number" class="form-control" [(ngModel)]="printer.charactersPerLine"
                                    name="charactersPerLine" />
                                <small class="form-text text-muted">
                                    Enter the number of characters per line. Adjust this if text overflows.
                                </small>
                            </div>
                        </form>
                    </div>
                </ng-template>
            </li>

            <li [ngbNavItem]="4">
                <a ngbNavLink>Customization</a>
                <ng-template ngbNavContent>
                    <div class="mt-4">
                        <form>
                            <!-- Layout Section -->
                            <!-- Layout Section -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Layout</label>
                                <div cdkDropList (cdkDropListDropped)="dropLayout($event)" class="list-group">
                                    <div class="list-group-item d-flex justify-content-between align-items-center"
                                        *ngFor="let item of printer.layout" cdkDrag>
                                        <span>
                                            <span class="badge bg-secondary me-2">{{ printer.layout.indexOf(item) + 1
                                                }}</span>
                                            {{ item }}
                                        </span>
                                        <span class="drag-handle bi bi-arrows-move" cdkDragHandle></span>
                                    </div>
                                </div>
                                <small class="form-text text-muted">
                                    Configure the order of the various receipt sections
                                </small>
                            </div>


                            <!-- Detail Customization -->
                            <!-- Detail Customization -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Detail Customization</label>
                                <div cdkDropList (cdkDropListDropped)="dropDetail($event)">
                                    <div class="list-group-item d-flex justify-content-between align-items-center mb-2"
                                        *ngFor="let detail of printer.detailCustomization" cdkDrag>
                                        <div class="d-flex align-items-center">
                                            <div class="form-check form-switch me-2">
                                                <input type="checkbox" class="form-check-input"
                                                    [(ngModel)]="detail.enabled" [name]="detail.key" />
                                            </div>
                                            {{ detail.label }}
                                        </div>
                                        <span class="drag-handle bi bi-arrows-move" cdkDragHandle></span>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-outline-secondary btn-sm mt-2"
                                    (click)="resetDetailCustomization()">Reset</button>
                                <small class="form-text text-muted">
                                    Customize which order details are displayed on the receipt. Rearrange the order
                                    using the drag handles.
                                </small>
                            </div>


                            <!-- Dish Customization -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Dish Customization</label>
                                <div *ngFor="let dish of printer.dishCustomization"
                                    class="d-flex justify-content-between align-items-center mb-2">
                                    <div>{{ dish.label }}</div>
                                    <div class="form-check form-switch">
                                        <input type="checkbox" class="form-check-input" [(ngModel)]="dish.enabled"
                                            [name]="dish.key" />
                                    </div>
                                </div>
                                <small class="form-text text-muted">
                                    Customize how dishes are displayed on receipts.
                                </small>
                            </div>

                            <!-- Dish Tag Seat Sort Priority -->
                            <div class="mb-4">
                                <label class="form-label fw-bold">Dish Tag Seat Sort Priority</label>
                                <select class="form-select" [(ngModel)]="printer.dishTagSortPriority"
                                    name="dishTagSortPriority">
                                    <option value="">Select from the dropdown or type to search...</option>
                                    <option *ngFor="let option of dishTagOptions" [value]="option">{{ option }}</option>
                                </select>
                            </div>

                            <!-- Show Order Totals -->
                            <div class="mb-4 d-flex justify-content-between align-items-center">
                                <label class="form-label fw-bold">Show Order Totals</label>
                                <div class="form-check form-switch">
                                    <input type="checkbox" class="form-check-input"
                                        [(ngModel)]="printer.showOrderTotals" name="showOrderTotals" />
                                </div>
                            </div>
                        </form>
                    </div>
                </ng-template>
            </li>

            <li [ngbNavItem]="5">
                <a ngbNavLink>Header & Footer</a>
                <ng-template ngbNavContent>
                    <div class="mb-4">
                        <label class="form-label fw-bold">
                            Receipt Header
                            <span class="optional-badge">OPTIONAL</span>
                        </label>

                        <!-- Rich Text Editor -->
                        <quill-editor [(ngModel)]="printer.header" [styles]="{height: '100px'}"></quill-editor>

                        <button type="button" class="btn btn-outline-warning btn-sm mt-2"
                            (click)="clearHeader()">Clear</button>

                        <small class="form-text text-muted">
                            Customize your receipt header with information such as your store name, business number,
                            etc.
                        </small>
                    </div>

                    <hr class="dotted-divider" />

                    <div class="mb-4">
                        <label class="form-label fw-bold">
                            Receipt Header
                            <span class="optional-badge">OPTIONAL</span>
                        </label>

                        <quill-editor [(ngModel)]="printer.header"
                            [modules]="{ toolbar: [['bold', 'italic', 'underline'], [{ 'list': 'ordered'}, { 'list': 'bullet' }], ['clean']] }"
                            theme="snow" style="height:120px;">
                        </quill-editor>

                        <button type="button" class="btn btn-outline-warning btn-sm mt-2"
                            (click)="clearHeader()">Clear</button>
                    </div>

                    <hr class="dotted-divider" />

                    <div class="mb-4">
                        <label class="form-label fw-bold">
                            Receipt Footer
                            <span class="optional-badge">OPTIONAL</span>
                        </label>

                        <quill-editor [(ngModel)]="printer.footer"
                            [modules]="{ toolbar: [['bold', 'italic', 'underline'], [{ 'list': 'ordered'}, { 'list': 'bullet' }], ['clean']] }"
                            theme="snow" style="height:120px;">
                        </quill-editor>

                        <button type="button" class="btn btn-outline-warning btn-sm mt-2"
                            (click)="clearFooter()">Clear</button>
                    </div>


                </ng-template>
            </li>
            <li [ngbNavItem]="6">
                <a ngbNavLink>Dishes to Print</a>
                <ng-template ngbNavContent> dishes to print content </ng-template>
            </li>
            <li [ngbNavItem]="7">
                <a ngbNavLink>Device</a>
                <ng-template ngbNavContent> device content </ng-template>
            </li>
        </ul>
        <div [ngbNavOutlet]="nav" class="mt-2"></div>
    </div>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-primary w-100" (click)="savePrinter()">
        Save
    </button>
</div>