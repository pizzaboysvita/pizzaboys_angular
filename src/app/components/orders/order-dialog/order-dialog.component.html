<div class="modal-content">
    <div class="header">
        <div class="order-number">#{{ data.orderNumber }}</div>
        <div class="est-ready-time" style="text-align: end;">
            Est. Ready Time - {{ data.estReadyTime }}
            <br />
            <small>Last updated {{ data.lastUpdated }} ago</small>
        </div>
    </div>
    <hr class="m-0" />
    <div class="modal-body pt-0">
        <div class="accordion-group">
            <div class="accordion-header" (click)="toggleStatus()">
                Change Status
                <span class="arrow">
                    <i class="ri-arrow-up-s-line" *ngIf="statusExpanded"></i>
                    <i class="ri-arrow-down-s-line" *ngIf="!statusExpanded"></i>
                </span>
            </div>
            <div class="accordion-body" *ngIf="statusExpanded">
                <div class="accordion-item" [class.current]="data.status === 'Cancelled'">
                    Cancelled
                </div>
                <div class="accordion-item" [class.current]="data.status === 'Un-Confirmed'">
                    Un-Confirmed
                </div>
                <div class="accordion-item" [class.current]="data.status === 'Confirmed'">
                    Confirmed
                </div>
                <div class="accordion-item" [class.current]="data.status === 'Ready'">
                    Ready
                </div>
                <div class="accordion-item" [class.current]="data.status === 'Complete'">
                    Complete (Current)
                </div>
            </div>
        </div>

        <div class="accordion-group">
            <div class="accordion-header" (click)="toggleReadyTime()">
                Modify Est. Ready Time
                <span class="arrow">
                    <i class="ri-arrow-up-s-line" *ngIf="readyTimeExpanded"></i>
                    <i class="ri-arrow-down-s-line" *ngIf="!readyTimeExpanded"></i>
                </span>
            </div>
            <div class="accordion-body" *ngIf="readyTimeExpanded">
                <div class="accordion-item">Add 5 minutes</div>
                <div class="accordion-item">Add 10 minutes</div>
            </div>
        </div>

        <div class="accordion-group">
            <div class="accordion-header" (click)="toggleActions()">
                Actions
                <span class="arrow">
                    <i class="ri-arrow-up-s-line" *ngIf="actionsExpanded"></i>
                    <i class="ri-arrow-down-s-line" *ngIf="!actionsExpanded"></i>
                </span>
            </div>
            <div class="accordion-body" *ngIf="actionsExpanded">
                <div class="accordion-item">Print - Online Ordering - Customer</div>
                <div class="accordion-item">Print - POS - Customer</div>
                <div class="accordion-item">Download PDF receipt</div>
                <div class="accordion-item">Archive Order</div>
            </div>
        </div>

        <button class="complete-button">
            <i class="ri-checkbox-circle-fill" style="font-size: 20px;"></i>
            Complete
        </button>

        <div class="tab-header">
            <div class="tab" [class.active]="activeTab === 'details'" (click)="selectTab('details')">
                Details
            </div>
            <div class="tab" [class.active]="activeTab === 'dishes'" (click)="selectTab('dishes')">
                Dishes
            </div>
            <div class="tab" [class.active]="activeTab === 'payments'" (click)="selectTab('payments')">
                Payments
            </div>
            <div class="tab" [class.active]="activeTab === 'log'" (click)="selectTab('log')">
                Log
            </div>
        </div>

        <div class="tab-content">
            <div *ngIf="activeTab === 'details'">
                <div class="row-info">
                    <p>Type:</p>
                    <span>{{ data.type }}</span>
                </div>
                <div class="row-info">
                    <p>Placed:</p>
                    <span>{{ data.placed }}</span>
                </div>
                <div class="row-info">
                    <p>Due:</p>
                    <span>{{ data.due }}</span>
                </div>
                <div class="row-info">
                    <p>Name:</p>
                    <span>{{ data.name }}</span>
                </div>
                <div class="row-info">
                    <p>E-Mail:</p>
                    <span>{{ data.email }}</span>
                </div>
                <div class="row-info">
                    <p>Phone:</p>
                    <span>{{ data.phone }}</span>
                </div>
            </div>

            <div *ngIf="activeTab === 'dishes'">
                <div class="dishes-header">
                    <span class="header-qty">Qty</span>
                    <span class="header-item">Item</span>
                    <span class="header-price">Price</span>
                </div>
                <div class="dish-item" *ngFor="let dish of data.dishes">
                    <div class="item-details-row">
                        <span class="qty">{{ dish.qty }}</span>
                        <div class="item-name-details">
                            <span class="item-name">{{ dish.item }}</span>
                            <div class="item-mods" *ngIf="dish.mods && dish.mods.length > 0">
                                <p class="mod-title">Base Choice</p>
                                <div *ngFor="let mod of dish.mods">{{ mod }}</div>
                            </div>
                            <div class="item-mods" *ngIf="dish.remove && dish.remove.length > 0">
                                <p class="mod-title">Remove Ingredients</p>
                                <div *ngFor="let remove of dish.remove">{{ remove }}</div>
                            </div>
                            <div class="item-notes" *ngIf="dish.notes">
                                <p class="mod-title">Notes:</p>
                                <div>{{ dish.notes }}</div>
                            </div>
                        </div>
                        <span class="price">${{ dish.price.toFixed(2) }}</span>
                    </div>
                </div>

                <div class="bill-summary">
                    <div class="summary-row">
                        <p>Cart</p>
                        <span>${{ data.payments?.cartTotal?.toFixed(2) }}</span>
                    </div>
                    <div class="summary-row">
                        <p>Credit / Debit Card Fee</p>
                        <span>${{ data.payments?.cardFee?.toFixed(2) }}</span>
                    </div>
                    <div class="summary-row">
                        <p>GST (15%) inc. in price</p>
                        <span>${{ data.payments?.gst?.toFixed(2) }}</span>
                    </div>
                    <div class="summary-row total-row">
                        <p>Total</p>
                        <span>${{ data.payments?.total?.toFixed(2) }}</span>
                    </div>
                </div>
            </div>

            <div *ngIf="activeTab === 'payments'">
                <div class="payment-row">
                    <div class="payment-icon">
                        <i class="ri-money-dollar-circle-line"></i>
                    </div>
                    <div class="payment-details">
                        <p>{{ data.payments?.method }}</p>
                        <small>Successful</small>
                    </div>
                    <div class="payment-amount">${{ data.payments?.total?.toFixed(2) }}</div>
                </div>
            </div>


            <div *ngIf="activeTab === 'log'">
                <small>Sorted from newest to oldest</small>
                <div class="log-entry" *ngFor="let entry of data.log; let i = index">
                    <div class="d-flex align-items-center">
                        <div class="log-number">{{ data.log.length - i }}
                        </div> <span class="ms-2">
                            Update Status</span>
                    </div>
                    <div class="log-details p-1">
                        <p>{{ entry.description }}</p>
                        <small>{{ entry.timestamp }}</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>