<div class="modal-content custom-modal">

  <!-- Header -->
  <div class="modal-header border-bottom pb-2 flex-column align-items-start">
    <h5 class="modal-title fw-bold">Takings</h5>
    <div class="small text-muted">
      Session started {{ sessionStart }}
    </div>

     <button type="button" class="btn-close" (click)="modal.dismissAll()">
     <i class="ri-close-line"></i>
  </button>
  </div>

  <!-- Tabs -->
  <div class="modal-tabs">
    <button class="tab" [class.active]="activeTab === 'end'"
            (click)="activeTab = 'end'">END OF DAY</button>

    <button class="tab" [class.active]="activeTab === 'history'"
            (click)="activeTab = 'history'">HISTORY</button>
  </div>

  <!-- Modal Body -->
  <div class="modal-body">

    <!-- END OF DAY TAB -->
    <div *ngIf="activeTab === 'end'">

      <p class="text-muted small">
        Finalise takings to ensure that you have collected the correct amount of money
        over the transactions completed in this session. Note that the below cash value
        includes your float. Summary figures will be shown after.
      </p>

      <!-- Table -->
      <div class="table-responsive">
    <div class="takings-scroll-container">
  <div class="takings-table-wrapper">

  <table class="takings-table">
    <thead>
      <tr>
        <th>Type</th>
        <th>Sales</th>
        <th>Refunds</th>
        <th>Cashout</th>
        <th>Expected</th>
        <th>Counted</th>
        <th>Variance</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let row of takingsRows">

        <td>{{ row.type }}</td>

        <td>{{ row.sales !== null ? ('$' + row.sales.toFixed(2)) : '-' }}</td>

        <td>{{ row.refunds !== null ? ('$' + row.refunds.toFixed(2)) : '-' }}</td>

        <td>{{ row.cashout !== null ? ('$' + row.cashout.toFixed(2)) : '-' }}</td>

        <td>{{ row.expected !== null ? ('$' + row.expected.toFixed(2)) : '-' }}</td>

        <!-- Counted -->
        <td>
          <ng-container *ngIf="row.editable; else dash">
            <input type="number"
                   class="counted-input"
                   [(ngModel)]="row.counted"
                   (input)="updateVariance(row)" />
          </ng-container>

          <ng-template #dash>-</ng-template>
        </td>

        <!-- Variance -->
        <td>
          <ng-container *ngIf="row.variance !== null; else dash2">
            <span [ngClass]="{ 'negative': row.variance < 0 }">
              {{ row.variance | currency:'USD':'symbol':'1.2-2' }}
            </span>
          </ng-container>

          <ng-template #dash2>-</ng-template>
        </td>

      </tr>
    </tbody>
  </table>

</div>
</div>


      <!-- Notes -->
      <div class="form-group mt-3">
        <textarea class="form-control" rows="2" placeholder="Notes"></textarea>
      </div>

      <!-- EFTPOS Cutover Toggle -->
      <div class="form-check mt-3">
        <input class="form-check-input" type="checkbox" id="cutoverToggle">
        <label class="form-check-label" for="cutoverToggle">
          Perform EFTPOS Settlement Cutover
        </label>
      </div>

    </div>
    </div>

    <!-- HISTORY TAB -->
    <div *ngIf="activeTab === 'history'">
        <ag-grid-angular class="ag-theme-alpine font-family my-grid" style="width: 100%" [columnDefs]="tableConfig"
            [rowData]="historyRows" [domLayout]="'autoHeight'" [pagination]="true" [paginationPageSize]="10"
            [gridOptions]="gridOptions" 
            [defaultColDef]="{ flex: 1, minWidth: 100, sortable: true }">
          </ag-grid-angular>
<!-- 
      <table class="table table-hover takings-history-table">
        <thead>
          <tr>
            <th>Takings #</th>
            <th>Session Ended</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let t of historyRows; let i = index">
            <td>{{ t.number }}</td>
            <td>
              <span *ngIf="t.current">CURRENT</span>
              <span *ngIf="!t.current">{{ t.ended }}</span>
            </td>
          </tr>
        </tbody>
      </table>

    
     <div class="takings-pagination">
  <div>
    Rows per page:
    <select class="form-select d-inline w-auto" [(ngModel)]="rowsPerPage">
      <option>5</option>
      <option>10</option>
      <option>25</option>
    </select>
  </div>

  <div>{{ pageStart }} - {{ pageEnd }} of {{ historyRows.length }}</div>

  <div>
    <button class="btn btn-sm btn-light">‹</button>
    <button class="btn btn-sm btn-light">›</button>
  </div>
</div> -->


    </div>

  </div>

  <!-- Footer -->
  <div class="modal-footer border-0">
    <button class="btn btn-dark">
      FINALISE TAKINGS
    </button>
  </div>
</div>
